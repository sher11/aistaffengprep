<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 1: Foundations - Staff Engineer Prep</title>
    <link rel="stylesheet" href="../assets/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="../index.html" class="logo">StaffEngPrep</a>
            <ul class="nav-links">
                <li><a href="index.html" style="color: var(--primary-color);">Coding</a></li>
                <li><a href="../system-design/index.html">System Design</a></li>
                <li><a href="../company-specific/index.html">Companies</a></li>
                <li><a href="../behavioral/index.html">Behavioral</a></li>
                <li><a href="../generative-ai/index.html">Gen AI</a></li>
            </ul>
        </div>
    </nav>

    <div class="layout-with-sidebar">
        <!-- Left Sidebar Navigation -->
        <aside class="sidebar" id="sidebar">
            <nav class="sidebar-nav">
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Getting Started</div>
                    <a href="index.html" class="sidebar-link">Introduction</a>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-section-title">Fundamentals</div>
                    <a href="module-01.html" class="sidebar-link active" data-module="1">
                        <span class="sidebar-link-number">1</span>Foundations
                    </a>
                    <a href="module-02.html" class="sidebar-link" data-module="2">
                        <span class="sidebar-link-number">2</span>Arrays & Two Pointers
                    </a>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-section-title">Core Patterns</div>
                    <a href="module-03.html" class="sidebar-link" data-module="3">
                        <span class="sidebar-link-number">3</span>Trees & Binary Search
                    </a>
                    <a href="module-04.html" class="sidebar-link" data-module="4">
                        <span class="sidebar-link-number">4</span>Graphs
                    </a>
                    <a href="module-05.html" class="sidebar-link" data-module="5">
                        <span class="sidebar-link-number">5</span>Dynamic Programming
                    </a>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-section-title">Advanced</div>
                    <a href="module-06.html" class="sidebar-link" data-module="6">
                        <span class="sidebar-link-number">6</span>Backtracking
                    </a>
                    <a href="module-07.html" class="sidebar-link" data-module="7">
                        <span class="sidebar-link-number">7</span>Heaps & Sorting
                    </a>
                    <a href="module-08.html" class="sidebar-link" data-module="8">
                        <span class="sidebar-link-number">8</span>Non-LeetCode Problems
                    </a>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-section-title">Interview Prep</div>
                    <a href="module-09.html" class="sidebar-link" data-module="9">
                        <span class="sidebar-link-number">9</span>Interview Simulation
                    </a>
                </div>
            </nav>
        </aside>

        <!-- Mobile sidebar toggle -->
        <button class="sidebar-toggle" id="sidebarToggle">☰</button>
        <div class="sidebar-overlay" id="sidebarOverlay"></div>

        <!-- Main Content -->
        <main class="main-content">
        <h1>Module 1: Foundations & Complexity Analysis</h1>

        <!-- Learning Objectives -->
        <div class="card mt-3">
            <h3>Learning Objectives</h3>
            <ul>
                <li>Analyze time and space complexity using Big-O notation</li>
                <li>Choose appropriate data structures based on operation requirements</li>
                <li>Implement and use fundamental data structures confidently</li>
                <li>Recognize when to apply amortized analysis</li>
            </ul>
        </div>

        <!-- Big-O Section -->
        <h2 class="mt-4">Big-O Notation</h2>

        <div class="collapsible open">
            <div class="collapsible-header">
                <span>Understanding Complexity</span>
                <span class="collapsible-icon">&#9660;</span>
            </div>
            <div class="collapsible-content">
                <p>Big-O describes the upper bound of algorithm growth rate as input size increases.</p>

                <div class="diagram-container interactive">
                    <!-- Interactive Big-O Complexity Visualization -->
                    <div id="complexity-animation" style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border-radius: 16px; padding: 30px; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
                        <h4 style="color: #fff; text-align: center; margin-bottom: 20px; font-size: 1.2rem;">Interactive Big-O Complexity Comparison</h4>

                        <!-- Input Size Slider -->
                        <div style="text-align: center; margin-bottom: 25px;">
                            <label style="color: #a0a0a0; font-size: 0.9rem;">Input Size (n): <span id="n-value" style="color: #00d4ff; font-weight: bold;">10</span></label>
                            <br>
                            <input type="range" id="n-slider" min="1" max="20" value="10" style="width: 80%; margin-top: 10px; accent-color: #00d4ff;">
                        </div>

                        <!-- Complexity Bars -->
                        <div id="complexity-bars" style="display: flex; flex-direction: column; gap: 12px;">
                            <div class="complexity-row" data-complexity="O(1)" data-calc="constant" style="display: flex; align-items: center; gap: 15px;">
                                <div style="width: 140px; color: #4ade80; font-family: monospace; font-weight: bold; font-size: 0.95rem;">O(1)</div>
                                <div style="flex: 1; height: 28px; background: rgba(255,255,255,0.1); border-radius: 14px; overflow: hidden; position: relative;">
                                    <div class="bar" style="height: 100%; background: linear-gradient(90deg, #4ade80, #22c55e); border-radius: 14px; transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1); width: 5%;"></div>
                                </div>
                                <div class="operations" style="width: 80px; color: #a0a0a0; font-size: 0.85rem; text-align: right;">1 op</div>
                            </div>
                            <div class="complexity-row" data-complexity="O(log n)" data-calc="logarithmic" style="display: flex; align-items: center; gap: 15px;">
                                <div style="width: 140px; color: #60a5fa; font-family: monospace; font-weight: bold; font-size: 0.95rem;">O(log n)</div>
                                <div style="flex: 1; height: 28px; background: rgba(255,255,255,0.1); border-radius: 14px; overflow: hidden; position: relative;">
                                    <div class="bar" style="height: 100%; background: linear-gradient(90deg, #60a5fa, #3b82f6); border-radius: 14px; transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1); width: 10%;"></div>
                                </div>
                                <div class="operations" style="width: 80px; color: #a0a0a0; font-size: 0.85rem; text-align: right;">3 ops</div>
                            </div>
                            <div class="complexity-row" data-complexity="O(n)" data-calc="linear" style="display: flex; align-items: center; gap: 15px;">
                                <div style="width: 140px; color: #facc15; font-family: monospace; font-weight: bold; font-size: 0.95rem;">O(n)</div>
                                <div style="flex: 1; height: 28px; background: rgba(255,255,255,0.1); border-radius: 14px; overflow: hidden; position: relative;">
                                    <div class="bar" style="height: 100%; background: linear-gradient(90deg, #facc15, #eab308); border-radius: 14px; transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1); width: 20%;"></div>
                                </div>
                                <div class="operations" style="width: 80px; color: #a0a0a0; font-size: 0.85rem; text-align: right;">10 ops</div>
                            </div>
                            <div class="complexity-row" data-complexity="O(n log n)" data-calc="linearithmic" style="display: flex; align-items: center; gap: 15px;">
                                <div style="width: 140px; color: #fb923c; font-family: monospace; font-weight: bold; font-size: 0.95rem;">O(n log n)</div>
                                <div style="flex: 1; height: 28px; background: rgba(255,255,255,0.1); border-radius: 14px; overflow: hidden; position: relative;">
                                    <div class="bar" style="height: 100%; background: linear-gradient(90deg, #fb923c, #f97316); border-radius: 14px; transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1); width: 35%;"></div>
                                </div>
                                <div class="operations" style="width: 80px; color: #a0a0a0; font-size: 0.85rem; text-align: right;">33 ops</div>
                            </div>
                            <div class="complexity-row" data-complexity="O(n^2)" data-calc="quadratic" style="display: flex; align-items: center; gap: 15px;">
                                <div style="width: 140px; color: #f87171; font-family: monospace; font-weight: bold; font-size: 0.95rem;">O(n^2)</div>
                                <div style="flex: 1; height: 28px; background: rgba(255,255,255,0.1); border-radius: 14px; overflow: hidden; position: relative;">
                                    <div class="bar" style="height: 100%; background: linear-gradient(90deg, #f87171, #ef4444); border-radius: 14px; transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1); width: 60%;"></div>
                                </div>
                                <div class="operations" style="width: 80px; color: #a0a0a0; font-size: 0.85rem; text-align: right;">100 ops</div>
                            </div>
                            <div class="complexity-row" data-complexity="O(2^n)" data-calc="exponential" style="display: flex; align-items: center; gap: 15px;">
                                <div style="width: 140px; color: #e879f9; font-family: monospace; font-weight: bold; font-size: 0.95rem;">O(2^n)</div>
                                <div style="flex: 1; height: 28px; background: rgba(255,255,255,0.1); border-radius: 14px; overflow: hidden; position: relative;">
                                    <div class="bar" style="height: 100%; background: linear-gradient(90deg, #e879f9, #d946ef); border-radius: 14px; transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1); width: 100%;"></div>
                                </div>
                                <div class="operations" style="width: 80px; color: #a0a0a0; font-size: 0.85rem; text-align: right;">1024 ops</div>
                            </div>
                        </div>

                        <!-- Real-World Examples on Hover -->
                        <div id="complexity-tooltip" style="margin-top: 25px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 10px; border-left: 3px solid #00d4ff; min-height: 60px;">
                            <p style="color: #d0d0d0; margin: 0; font-size: 0.9rem;"><strong style="color: #00d4ff;">Hover over a complexity</strong> to see real-world examples and when each is acceptable.</p>
                        </div>
                    </div>

                    <script>
                    (function() {
                        const slider = document.getElementById('n-slider');
                        const nValue = document.getElementById('n-value');
                        const tooltip = document.getElementById('complexity-tooltip');

                        const examples = {
                            'O(1)': { example: 'Array access, hash table lookup', acceptable: 'Always preferred. Used in: HashMap get/put, array indexing.' },
                            'O(log n)': { example: 'Binary search, balanced BST operations', acceptable: 'Excellent for large datasets. Used in: Database indexes, binary search.' },
                            'O(n)': { example: 'Linear search, single loop', acceptable: 'Acceptable for most cases. Used in: Finding max/min, simple iterations.' },
                            'O(n log n)': { example: 'Efficient sorting (mergesort, quicksort)', acceptable: 'Standard for sorting. Used in: Most sorting libraries, divide-and-conquer.' },
                            'O(n^2)': { example: 'Nested loops, bubble sort', acceptable: 'Avoid for n > 10,000. Used in: Small datasets, some graph algorithms.' },
                            'O(2^n)': { example: 'Recursive fibonacci, subset generation', acceptable: 'Only for n < 25. Used in: Brute force, exhaustive search (use DP instead!).' }
                        };

                        function updateBars(n) {
                            const maxOps = Math.pow(2, Math.min(n, 20));
                            const rows = document.querySelectorAll('#complexity-bars .complexity-row');

                            rows.forEach(row => {
                                const calc = row.dataset.calc;
                                let ops;
                                switch(calc) {
                                    case 'constant': ops = 1; break;
                                    case 'logarithmic': ops = Math.max(1, Math.log2(n)); break;
                                    case 'linear': ops = n; break;
                                    case 'linearithmic': ops = n * Math.log2(Math.max(2, n)); break;
                                    case 'quadratic': ops = n * n; break;
                                    case 'exponential': ops = Math.pow(2, n); break;
                                }

                                const bar = row.querySelector('.bar');
                                const opsDisplay = row.querySelector('.operations');
                                const percentage = Math.min(100, (Math.log(ops + 1) / Math.log(maxOps + 1)) * 100);

                                bar.style.width = Math.max(3, percentage) + '%';
                                opsDisplay.textContent = ops >= 1000000 ? (ops/1000000).toFixed(1) + 'M ops' :
                                                        ops >= 1000 ? (ops/1000).toFixed(1) + 'K ops' :
                                                        Math.round(ops) + ' ops';
                            });
                        }

                        slider.addEventListener('input', function() {
                            const n = parseInt(this.value);
                            nValue.textContent = n;
                            updateBars(n);
                        });

                        document.querySelectorAll('#complexity-bars .complexity-row').forEach(row => {
                            row.style.cursor = 'pointer';
                            row.addEventListener('mouseenter', function() {
                                const complexity = this.dataset.complexity;
                                const info = examples[complexity];
                                tooltip.innerHTML = '<p style="color: #d0d0d0; margin: 0 0 8px 0; font-size: 0.9rem;"><strong style="color: #00d4ff;">' + complexity + '</strong>: ' + info.example + '</p><p style="color: #a0a0a0; margin: 0; font-size: 0.85rem;">' + info.acceptable + '</p>';
                                this.style.transform = 'scale(1.02)';
                                this.style.transition = 'transform 0.2s ease';
                            });
                            row.addEventListener('mouseleave', function() {
                                this.style.transform = 'scale(1)';
                            });
                        });

                        updateBars(10);
                    })();
                    </script>
                </div>

                <h4>Key Rules</h4>
                <ul>
                    <li><strong>Drop constants:</strong> O(2n) → O(n)</li>
                    <li><strong>Drop lower-order terms:</strong> O(n² + n) → O(n²)</li>
                    <li><strong>Different inputs use different variables:</strong> O(a + b), not O(n)</li>
                </ul>
            </div>
        </div>

        <!-- Data Structures Section -->
        <h2 class="mt-4">Core Data Structures</h2>

        <div class="collapsible">
            <div class="collapsible-header">
                <span>Arrays vs Linked Lists</span>
                <span class="collapsible-icon">&#9660;</span>
            </div>
            <div class="collapsible-content">
                <table style="width: 100%; border-collapse: collapse; margin: 1rem 0;">
                    <thead>
                        <tr style="background: var(--border-color);">
                            <th style="padding: 0.75rem; text-align: left; border: 1px solid var(--border-color);">Operation</th>
                            <th style="padding: 0.75rem; text-align: left; border: 1px solid var(--border-color);">Array</th>
                            <th style="padding: 0.75rem; text-align: left; border: 1px solid var(--border-color);">Linked List</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">Access</td>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">O(1)</td>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">O(n)</td>
                        </tr>
                        <tr>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">Search</td>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">O(n)</td>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">O(n)</td>
                        </tr>
                        <tr>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">Insert (beginning)</td>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">O(n)</td>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">O(1)</td>
                        </tr>
                        <tr>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">Insert (end)</td>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">O(1)*</td>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">O(1)**</td>
                        </tr>
                        <tr>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">Delete</td>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">O(n)</td>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">O(1)***</td>
                        </tr>
                    </tbody>
                </table>
                <p class="text-muted">* Amortized. ** With tail pointer. *** With reference to node.</p>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <span>Hash Tables</span>
                <span class="collapsible-icon">&#9660;</span>
            </div>
            <div class="collapsible-content">
                <p>Hash tables provide O(1) average-case operations through key-to-index mapping.</p>

                <div class="code-block">
                    <pre><code class="language-python"># Hash table operations (average case)
d = {}
d[key] = value    # O(1) insert
d[key]            # O(1) lookup
del d[key]        # O(1) delete
key in d          # O(1) membership

# Common pattern: Two Sum
def two_sum(nums, target):
    seen = {}
    for i, num in enumerate(nums):
        complement = target - num
        if complement in seen:
            return [seen[complement], i]
        seen[num] = i
    return []</code></pre>
                </div>

                <h4>Collision Handling</h4>
                <ul>
                    <li><strong>Chaining:</strong> Each bucket contains a linked list</li>
                    <li><strong>Open Addressing:</strong> Find next available slot</li>
                </ul>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <span>Stacks & Queues</span>
                <span class="collapsible-icon">&#9660;</span>
            </div>
            <div class="collapsible-content">
                <div class="diagram-container interactive">
                    <!-- Interactive Stack & Queue Animation -->
                    <div id="stack-queue-animation" style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border-radius: 16px; padding: 30px; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px;">
                            <!-- Stack Section -->
                            <div style="text-align: center;">
                                <h4 style="color: #4ade80; margin-bottom: 15px; font-size: 1.1rem;">Stack (LIFO)</h4>
                                <p style="color: #a0a0a0; font-size: 0.8rem; margin-bottom: 15px;">Last In, First Out</p>

                                <div id="stack-container" style="display: flex; flex-direction: column-reverse; align-items: center; min-height: 200px; background: rgba(255,255,255,0.05); border-radius: 12px; padding: 15px; margin-bottom: 15px; border: 2px dashed rgba(74, 222, 128, 0.3);">
                                    <!-- Stack items will be added here -->
                                </div>

                                <div style="display: flex; gap: 10px; justify-content: center;">
                                    <button id="stack-push" style="padding: 10px 20px; background: linear-gradient(135deg, #4ade80, #22c55e); border: none; border-radius: 8px; color: #fff; font-weight: bold; cursor: pointer; transition: all 0.3s ease;">Push</button>
                                    <button id="stack-pop" style="padding: 10px 20px; background: linear-gradient(135deg, #f87171, #ef4444); border: none; border-radius: 8px; color: #fff; font-weight: bold; cursor: pointer; transition: all 0.3s ease;">Pop</button>
                                </div>
                                <p id="stack-message" style="color: #60a5fa; font-size: 0.85rem; margin-top: 10px; min-height: 20px;"></p>
                            </div>

                            <!-- Queue Section -->
                            <div style="text-align: center;">
                                <h4 style="color: #60a5fa; margin-bottom: 15px; font-size: 1.1rem;">Queue (FIFO)</h4>
                                <p style="color: #a0a0a0; font-size: 0.8rem; margin-bottom: 15px;">First In, First Out</p>

                                <div style="position: relative; min-height: 200px; background: rgba(255,255,255,0.05); border-radius: 12px; padding: 15px; margin-bottom: 15px; border: 2px dashed rgba(96, 165, 250, 0.3);">
                                    <div style="position: absolute; top: 10px; left: 15px; color: #4ade80; font-size: 0.75rem;">Enqueue</div>
                                    <div style="position: absolute; top: 10px; right: 15px; color: #f87171; font-size: 0.75rem;">Dequeue</div>
                                    <div id="queue-container" style="display: flex; flex-direction: row; align-items: center; justify-content: flex-start; min-height: 60px; margin-top: 30px; gap: 8px; overflow-x: auto; padding: 10px;">
                                        <!-- Queue items will be added here -->
                                    </div>
                                </div>

                                <div style="display: flex; gap: 10px; justify-content: center;">
                                    <button id="queue-enqueue" style="padding: 10px 20px; background: linear-gradient(135deg, #4ade80, #22c55e); border: none; border-radius: 8px; color: #fff; font-weight: bold; cursor: pointer; transition: all 0.3s ease;">Enqueue</button>
                                    <button id="queue-dequeue" style="padding: 10px 20px; background: linear-gradient(135deg, #f87171, #ef4444); border: none; border-radius: 8px; color: #fff; font-weight: bold; cursor: pointer; transition: all 0.3s ease;">Dequeue</button>
                                </div>
                                <p id="queue-message" style="color: #60a5fa; font-size: 0.85rem; margin-top: 10px; min-height: 20px;"></p>
                            </div>
                        </div>

                        <!-- Comparison Info -->
                        <div style="margin-top: 25px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 10px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div style="border-left: 3px solid #4ade80; padding-left: 15px;">
                                <p style="color: #4ade80; margin: 0 0 5px 0; font-weight: bold; font-size: 0.9rem;">Stack Use Cases</p>
                                <p style="color: #a0a0a0; margin: 0; font-size: 0.85rem;">Undo/redo, function calls, bracket matching, DFS</p>
                            </div>
                            <div style="border-left: 3px solid #60a5fa; padding-left: 15px;">
                                <p style="color: #60a5fa; margin: 0 0 5px 0; font-weight: bold; font-size: 0.9rem;">Queue Use Cases</p>
                                <p style="color: #a0a0a0; margin: 0; font-size: 0.85rem;">Task scheduling, BFS, message queues, print spooling</p>
                            </div>
                        </div>
                    </div>

                    <script>
                    (function() {
                        let stackCounter = 0;
                        let queueCounter = 0;
                        const stackContainer = document.getElementById('stack-container');
                        const queueContainer = document.getElementById('queue-container');
                        const stackMessage = document.getElementById('stack-message');
                        const queueMessage = document.getElementById('queue-message');

                        function createItem(value, color) {
                            const item = document.createElement('div');
                            item.style.cssText = 'padding: 12px 25px; background: linear-gradient(135deg, ' + color + '); border-radius: 8px; color: #fff; font-weight: bold; font-size: 0.9rem; animation: slideIn 0.3s ease; box-shadow: 0 4px 15px rgba(0,0,0,0.3);';
                            item.textContent = value;
                            item.dataset.value = value;
                            return item;
                        }

                        // Add CSS animation
                        const style = document.createElement('style');
                        style.textContent = '@keyframes slideIn { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } } @keyframes slideOut { from { opacity: 1; transform: scale(1); } to { opacity: 0; transform: scale(0.8); } }';
                        document.head.appendChild(style);

                        // Stack operations
                        document.getElementById('stack-push').addEventListener('click', function() {
                            if (stackContainer.children.length >= 5) {
                                stackMessage.textContent = 'Stack full! (max 5 for demo)';
                                stackMessage.style.color = '#f87171';
                                return;
                            }
                            stackCounter++;
                            const item = createItem(stackCounter, '#4ade80, #22c55e');
                            stackContainer.appendChild(item);
                            stackMessage.textContent = 'Pushed: ' + stackCounter + ' (now on top)';
                            stackMessage.style.color = '#4ade80';
                        });

                        document.getElementById('stack-pop').addEventListener('click', function() {
                            if (stackContainer.children.length === 0) {
                                stackMessage.textContent = 'Stack empty!';
                                stackMessage.style.color = '#f87171';
                                return;
                            }
                            const item = stackContainer.lastChild;
                            const value = item.dataset.value;
                            item.style.animation = 'slideOut 0.3s ease forwards';
                            setTimeout(() => item.remove(), 300);
                            stackMessage.textContent = 'Popped: ' + value + ' (was on top)';
                            stackMessage.style.color = '#f87171';
                        });

                        // Queue operations
                        document.getElementById('queue-enqueue').addEventListener('click', function() {
                            if (queueContainer.children.length >= 5) {
                                queueMessage.textContent = 'Queue full! (max 5 for demo)';
                                queueMessage.style.color = '#f87171';
                                return;
                            }
                            queueCounter++;
                            const item = createItem(queueCounter, '#60a5fa, #3b82f6');
                            queueContainer.appendChild(item);
                            queueMessage.textContent = 'Enqueued: ' + queueCounter + ' (added to back)';
                            queueMessage.style.color = '#4ade80';
                        });

                        document.getElementById('queue-dequeue').addEventListener('click', function() {
                            if (queueContainer.children.length === 0) {
                                queueMessage.textContent = 'Queue empty!';
                                queueMessage.style.color = '#f87171';
                                return;
                            }
                            const item = queueContainer.firstChild;
                            const value = item.dataset.value;
                            item.style.animation = 'slideOut 0.3s ease forwards';
                            setTimeout(() => item.remove(), 300);
                            queueMessage.textContent = 'Dequeued: ' + value + ' (was at front)';
                            queueMessage.style.color = '#f87171';
                        });

                        // Add hover effects to buttons
                        document.querySelectorAll('#stack-queue-animation button').forEach(btn => {
                            btn.addEventListener('mouseenter', function() {
                                this.style.transform = 'translateY(-2px)';
                                this.style.boxShadow = '0 6px 20px rgba(0,0,0,0.3)';
                            });
                            btn.addEventListener('mouseleave', function() {
                                this.style.transform = 'translateY(0)';
                                this.style.boxShadow = 'none';
                            });
                        });
                    })();
                    </script>
                </div>

                <div class="code-block">
                    <pre><code class="language-python"># Stack: Valid Parentheses
def is_valid(s):
    stack = []
    mapping = {')': '(', '}': '{', ']': '['}

    for char in s:
        if char in mapping:
            if not stack or stack.pop() != mapping[char]:
                return False
        else:
            stack.append(char)

    return len(stack) == 0

# Queue with deque
from collections import deque
queue = deque()
queue.append(1)     # enqueue
queue.popleft()     # dequeue</code></pre>
                </div>
            </div>
        </div>

        <!-- Decision Tree -->
        <h2 class="mt-4">Data Structure Selection</h2>

        <div class="diagram-container">
            <div class="mermaid">
flowchart TD
    A[Need to store data] --> B{Need key-value pairs?}
    B -->|Yes| C[Hash Table]
    B -->|No| D{Need ordering?}
    D -->|Yes| E{By value?}
    D -->|No| F{LIFO or FIFO?}
    E -->|Yes| G[BST/TreeMap]
    E -->|No, insertion order| H[LinkedHashMap]
    F -->|LIFO| I[Stack]
    F -->|FIFO| J[Queue]
    F -->|Neither| K{Fast random access?}
    K -->|Yes| L[Array]
    K -->|No| M[Linked List]
            </div>
        </div>

        <!-- Real-World Scale Examples -->
        <h2 class="mt-4">Real-World Scale Examples</h2>

        <div class="collapsible">
            <div class="collapsible-header">
                <span>Database Indexes: Handling Millions of Records</span>
                <span class="collapsible-icon">&#9660;</span>
            </div>
            <div class="collapsible-content">
                <h4>Why Database Indexing Matters</h4>
                <p>Amazon's DynamoDB handles over 45 million requests per second. Without proper indexing, each query would scan millions of records (O(n)). With B-tree indexes, lookups become O(log n).</p>

                <h4>Real Numbers</h4>
                <ul>
                    <li><strong>Without index:</strong> 10M row table scan = 10,000,000 comparisons</li>
                    <li><strong>With B-tree index:</strong> log2(10M) = ~24 comparisons</li>
                    <li><strong>Improvement:</strong> 400,000x faster</li>
                </ul>

                <div class="code-block">
                    <pre><code class="language-python"># Simulating index vs table scan performance
import time

def table_scan(records, target_id):
    """O(n) - Linear scan through all records"""
    for record in records:
        if record['id'] == target_id:
            return record
    return None

def index_lookup(index, records, target_id):
    """O(log n) - Binary search on sorted index"""
    # In real DBs, this is a B-tree with ~100 children per node
    left, right = 0, len(index) - 1
    while left <= right:
        mid = (left + right) // 2
        if index[mid][0] == target_id:
            return records[index[mid][1]]
        elif index[mid][0] < target_id:
            left = mid + 1
        else:
            right = mid - 1
    return None

# PostgreSQL B-tree: ~4 levels for 100M records
# Each level is one disk read (~10ms HDD, ~0.1ms SSD)
# Total: 40ms HDD vs scanning 100M records (hours)</code></pre>
                </div>

                <h4>Hash Index Trade-offs at Scale</h4>
                <p>MySQL's MEMORY engine uses hash indexes for O(1) lookups, but they don't support range queries. This is why most databases default to B-trees despite the O(log n) vs O(1) trade-off - range queries are too common.</p>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <span>Redis: In-Memory Data Structures at 100K+ ops/sec</span>
                <span class="collapsible-icon">&#9660;</span>
            </div>
            <div class="collapsible-content">
                <p>Redis powers real-time leaderboards, session stores, and caches for companies like Twitter, GitHub, and Stack Overflow. Understanding its data structure choices reveals why complexity analysis matters:</p>

                <table style="width: 100%; border-collapse: collapse; margin: 1rem 0;">
                    <thead>
                        <tr style="background: var(--border-color);">
                            <th style="padding: 0.75rem; border: 1px solid var(--border-color);">Redis Type</th>
                            <th style="padding: 0.75rem; border: 1px solid var(--border-color);">Internal Structure</th>
                            <th style="padding: 0.75rem; border: 1px solid var(--border-color);">Use Case</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">String</td>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">SDS (Simple Dynamic String)</td>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">Session tokens, counters</td>
                        </tr>
                        <tr>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">Hash</td>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">Hashtable or Ziplist</td>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">User objects, config</td>
                        </tr>
                        <tr>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">Sorted Set</td>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">Skip List + Hash</td>
                            <td style="padding: 0.75rem; border: 1px solid var(--border-color);">Leaderboards, rate limiting</td>
                        </tr>
                    </tbody>
                </table>

                <p><strong>Skip Lists for Sorted Sets:</strong> Redis chose skip lists over balanced trees because they're simpler to implement correctly and have similar O(log n) performance. At 100K operations/second, the constant factors matter - skip lists have better cache locality.</p>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <span>Stack Overflow: Optimizing for Read-Heavy Workloads</span>
                <span class="collapsible-icon">&#9660;</span>
            </div>
            <div class="collapsible-content">
                <p>Stack Overflow serves 1.3 billion page views per month with just 9 web servers. Their secret: choosing the right data structures and caching strategy.</p>

                <ul>
                    <li><strong>Question lists:</strong> Pre-computed and cached (avoid O(n log n) sorts on every request)</li>
                    <li><strong>Tag relationships:</strong> Hash tables for O(1) lookup of related tags</li>
                    <li><strong>Full-text search:</strong> Inverted indexes (hash table mapping words to document IDs)</li>
                </ul>

                <p>Key insight: Staff engineers don't just pick the "fastest" data structure - they pick the one that optimizes for the actual access pattern (99% reads, 1% writes for Q&A sites).</p>
            </div>
        </div>

        <!-- Quiz Section -->
        <h2 class="mt-4">Self-Check Quiz</h2>

        <div class="quiz-container" id="module-quiz">
            <!-- Quiz loaded by JavaScript -->
        </div>

        <!-- Interview Follow-up Questions -->
        <h2 class="mt-4">Interview Follow-up Questions</h2>

        <div class="collapsible">
            <div class="collapsible-header">
                <span>Common Follow-ups & What Interviewers Look For</span>
                <span class="collapsible-icon">&#9660;</span>
            </div>
            <div class="collapsible-content">
                <h4>1. "What's the worst-case vs average-case for hash table operations?"</h4>
                <p><strong>What they're looking for:</strong></p>
                <ul>
                    <li>Average: O(1) for insert, lookup, delete</li>
                    <li>Worst-case: O(n) when all keys hash to same bucket</li>
                    <li>Discussion of load factor and rehashing</li>
                </ul>
                <p><strong>Red flags:</strong> Only knowing average case, not understanding collision handling.</p>

                <h4>2. "When would you choose a linked list over an array?"</h4>
                <p><strong>What they're looking for:</strong></p>
                <ul>
                    <li>Frequent insertions/deletions at arbitrary positions</li>
                    <li>Unknown or highly variable size</li>
                    <li>No need for random access</li>
                    <li>Real examples: LRU cache (doubly-linked list), undo history</li>
                </ul>
                <p><strong>Red flags:</strong> Generic answers without concrete use cases.</p>

                <h4>3. "How does amortized O(1) differ from O(1)?"</h4>
                <p><strong>What they're looking for:</strong></p>
                <ul>
                    <li>Amortized = average over a sequence of operations</li>
                    <li>Example: ArrayList doubling - most appends are O(1), occasional O(n) resize</li>
                    <li>Total cost / number of operations = O(1)</li>
                </ul>
                <p><strong>Red flags:</strong> Not knowing the difference, or thinking amortized means "approximate".</p>

                <h4>4. "Why is O(n log n) the lower bound for comparison-based sorting?"</h4>
                <p><strong>What they're looking for:</strong></p>
                <ul>
                    <li>Decision tree argument: n! possible orderings</li>
                    <li>Binary tree with n! leaves needs log(n!) = O(n log n) height</li>
                    <li>Mention non-comparison sorts that beat this (counting, radix)</li>
                </ul>
                <p><strong>Red flags:</strong> Not distinguishing comparison-based from other sorting.</p>

                <h4>5. "How would you handle hash collisions in a distributed system?"</h4>
                <p><strong>What they're looking for:</strong></p>
                <ul>
                    <li>Consistent hashing for distributing load</li>
                    <li>Discussion of partition tolerance and data locality</li>
                    <li>Real examples: Redis Cluster, DynamoDB</li>
                </ul>
                <p><strong>Red flags:</strong> Only knowing local hash table implementations, not distributed considerations.</p>
            </div>
        </div>

        <!-- Practice Problems -->
        <h2 class="mt-4">Practice Problems</h2>

        <div class="card">
            <h4>Easy</h4>
            <ul>
                <li><a href="https://leetcode.com/problems/valid-parentheses/" target="_blank">Valid Parentheses (LeetCode #20)</a></li>
                <li><a href="https://leetcode.com/problems/two-sum/" target="_blank">Two Sum (LeetCode #1)</a></li>
                <li><a href="https://leetcode.com/problems/reverse-linked-list/" target="_blank">Reverse Linked List (LeetCode #206)</a></li>
            </ul>

            <h4 class="mt-3">Medium</h4>
            <ul>
                <li><a href="https://leetcode.com/problems/lru-cache/" target="_blank">LRU Cache (LeetCode #146)</a></li>
                <li><a href="https://leetcode.com/problems/group-anagrams/" target="_blank">Group Anagrams (LeetCode #49)</a></li>
            </ul>
        </div>

        <!-- Review Concepts -->
        <h2 class="mt-4">Spaced Repetition</h2>

        <div class="review-schedule" id="module-review">
            <!-- Review schedule loaded by JavaScript -->
        </div>

        <!-- Navigation -->
        <div class="flex flex-between mt-4">
            <a href="index.html" class="btn btn-secondary">&larr; Back to Overview</a>
            <button class="btn btn-primary" onclick="completeModule()">Mark Complete &rarr;</button>
        </div>
        </main>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="../assets/js/app.js"></script>
    <script>
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Sidebar toggle for mobile
            const sidebar = document.getElementById('sidebar');
            const sidebarToggle = document.getElementById('sidebarToggle');
            const sidebarOverlay = document.getElementById('sidebarOverlay');

            sidebarToggle.addEventListener('click', function() {
                sidebar.classList.toggle('open');
                sidebarOverlay.classList.toggle('open');
            });

            sidebarOverlay.addEventListener('click', function() {
                sidebar.classList.remove('open');
                sidebarOverlay.classList.remove('open');
            });

            // Update sidebar links based on completion status
            document.querySelectorAll('.sidebar-link[data-module]').forEach(link => {
                const moduleNum = parseInt(link.dataset.module);
                if (StaffEngPrep.ProgressTracker.isModuleComplete('coding', moduleNum)) {
                    link.classList.add('completed');
                }
            });

            // Initialize quiz
            const quizQuestions = [
                {
                    question: "What is the time complexity of accessing an element in an array by index?",
                    options: ["O(n)", "O(log n)", "O(1)", "O(n²)"],
                    correct: 2,
                    explanation: "Array access by index is O(1) because arrays provide direct memory access."
                },
                {
                    question: "What is the worst-case time complexity for hash table lookup?",
                    options: ["O(1)", "O(log n)", "O(n)", "O(n²)"],
                    correct: 2,
                    explanation: "When all keys hash to the same bucket (worst case), lookup becomes O(n)."
                },
                {
                    question: "An algorithm has two nested loops, each iterating n times. What is the time complexity?",
                    options: ["O(n)", "O(2n)", "O(n²)", "O(n log n)"],
                    correct: 2,
                    explanation: "Nested loops multiply: n × n = O(n²)"
                },
                {
                    question: "Which data structure gives O(1) insertion at the beginning?",
                    options: ["Array", "Linked List", "Hash Table", "BST"],
                    correct: 1,
                    explanation: "Linked list can insert at head in O(1) by updating pointers. Arrays require shifting all elements."
                }
            ];

            const quiz = new StaffEngPrep.Quiz('module-quiz', quizQuestions);
            quiz.render();

            // Initialize review schedule
            const concepts = [
                { id: 'big-o-rules', name: 'Big-O Rules' },
                { id: 'array-vs-linkedlist', name: 'Array vs Linked List' },
                { id: 'hash-table-operations', name: 'Hash Table Operations' },
                { id: 'stack-queue-usage', name: 'Stack & Queue Usage' }
            ];
            StaffEngPrep.renderReviewSchedule('module-review', concepts);
        });

        function completeModule() {
            StaffEngPrep.ProgressTracker.markModuleComplete('coding', 1);
            alert('Module 1 marked as complete!');
            window.location.href = 'module-02.html';
        }
    </script>
</body>
</html>
